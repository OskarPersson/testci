environment:

  matrix:

    # For Python versions available on Appveyor, see
    # http://www.appveyor.com/docs/installed-software#python

    # -------- PYTHON 2.7, Django 1.10 --------

    - PYTHON: "27"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "27"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2014

    - PYTHON: "27"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2016

    - PYTHON: "27"
      DJANGO_VERSION: "1.10"
      SQL: MySQL57

    # -------- PYTHON 2.7, Django 1.11b1 --------

    - PYTHON: "27"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "27"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2014

    - PYTHON: "27"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2016

    - PYTHON: "27"
      DJANGO_VERSION: "1.11b1"
      SQL: MySQL57

    # -------- PYTHON 3.4, Django 1.10 --------

    - PYTHON: "34"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "34"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2014

    - PYTHON: "34"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2016

    - PYTHON: "34"
      DJANGO_VERSION: "1.10"
      SQL: MySQL57

    # -------- PYTHON 3.4, Django 1.11b1 --------

    - PYTHON: "34"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "34"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2014

    - PYTHON: "34"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2016

    - PYTHON: "34"
      DJANGO_VERSION: "1.11b1"
      SQL: MySQL57

    # -------- PYTHON 3.5, Django 1.10 --------

    - PYTHON: "35"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "35"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2014

    - PYTHON: "35"
      DJANGO_VERSION: "1.10"
      SQL: MSSQL$SQL2016

    - PYTHON: "35"
      DJANGO_VERSION: "1.10"
      SQL: MySQL57

    # -------- PYTHON 3.5, Django 1.11b1 --------

    - PYTHON: "35"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "35"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2014

    - PYTHON: "35"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2016

    - PYTHON: "35"
      DJANGO_VERSION: "1.11b1"
      SQL: MySQL57

    # -------- PYTHON 3.6, Django 1.11b1 --------

    - PYTHON: "36"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2012SP1

    - PYTHON: "36"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2014

    - PYTHON: "36"
      DJANGO_VERSION: "1.11b1"
      SQL: MSSQL$SQL2016

    - PYTHON: "36"
      DJANGO_VERSION: "1.11b1"
      SQL: MySQL57


platform:
  - x64

image: Visual Studio 2015

init:
- cmd: net start %SQL%

install:
  - cmd: git clone https://github.com/lxml/lxml
  - cmd: cd lxml
  - cmd: SET PATH=C:\\Python%PYTHON%-x64;c:\\Python%PYTHON%-x64\\scripts;%PATH%
  - cmd: python -m pip.__main__ install -U pip wheel setuptools
  - cmd: pip install -r requirements.txt --install-option="--no-cython-compile"
  - cmd: cd ..

  - cmd: python -m pip install lxml
  - "python -m pip install mysqlclient-1.3.10-cp%PYTHON%-cp%PYTHON%m-win_amd64.whl"
  - "python -m pip install -r requirements.txt"
  - "python -m pip install django==%DJANGO_VERSION%"
  - nuget install redis-64 -excludeversion
  - redis-64\tools\redis-server.exe --service-install
  - redis-64\tools\redis-server.exe --service-start

build: off

test_script:
  - "C:\\Python%PYTHON%-x64\\python.exe manage.py test"
